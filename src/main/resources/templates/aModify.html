<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/css/aEnroll.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <title>aModify</title>
  </head>
  <body>
    <div th:replace="~{layouts/header :: header}"></div>

    <div class="frame">
      <div class="container">
        <form
          th:action="@{/edit-answer/{postId}/{answerId}(postId=${answerFormDto.postId},answerId=${answerFormDto.answerId})}"
          method="put"
        >
          <div class="item1">
            <div class="answer_enroll">ë‹µë³€ ìˆ˜ì •</div>
            <textarea
              class="text_box"
              rows="10"
              cols="156"
              name="content"
              th:text="${answerFormDto.content}"
              placeholder="ë‹µë³€ì„ ì…ë ¥í•˜ì„¸ìš”"
            ></textarea>
          </div>
          <div class="item2">
            <input type="file" id="file-input" name="imageList" style="display: none" multiple />
            <label for="file-input" class="add_file">ğŸ“Add file</label>
            <button type="submit" class="submit_btn">ìˆ˜ì •</button>
            <button type="button" class="cancel_btn">ì·¨ì†Œ</button>
          </div>
        </form>
        <div id="file-list-box">
          <ul id="file-list"></ul>
        </div>
      </div>
    </div>

    <div th:replace="~{layouts/footer :: footer}"></div>

    <script>
      let fileInput = document.getElementById('file-input');
      let fileList = document.getElementById('file-list');
      let cancelBtn = document.querySelector('.cancel_btn');

      // íŒŒì¼ ì…ë ¥ ê°’ì´ ë³€ê²½ë  ë•Œ ì‹¤í–‰ë˜ëŠ” ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ì¶”ê°€
      fileInput.addEventListener('change', () => {
        // ì„ íƒëœ íŒŒì¼ë“¤ì„ ë°°ì—´ë¡œ ë³€í™˜í•˜ì—¬ ë³€ìˆ˜ì— ì €ì¥
        let selectedFiles = Array.from(fileInput.files);

        // ì„ íƒëœ íŒŒì¼ë“¤ì„ ë°˜ë³µí•˜ë©´ì„œ ê° íŒŒì¼ì— ëŒ€í•´ ì‹¤í–‰ë  ì½”ë“œë¥¼ ì •ì˜
        selectedFiles.forEach((file) => {
          // ìƒˆë¡œìš´ ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œì¸ <li> ìš”ì†Œë¥¼ ìƒì„±
          let listItem = document.createElement('li');

          // íŒŒì¼ ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€ë¥¼ ìœ„í•œ <img> ìš”ì†Œë¥¼ ìƒì„±
          let filePreview = document.createElement('img');
          filePreview.classList.add('file-preview');
          let reader = new FileReader();

          // íŒŒì¼ì´ ë¡œë“œë˜ì—ˆì„ ë•Œ ì´ë¯¸ì§€ í¬ê¸°ë¥¼ ì¡°ì •í•˜ê³  ë¯¸ë¦¬ë³´ê¸° ìš”ì†Œì˜ ì†ŒìŠ¤ë¡œ ì„¤ì •
          reader.onload = function (e) {
            resizeImage(e.target.result, 300, 300, (resizedImage) => {
              filePreview.src = resizedImage;
            });
          };

          // íŒŒì¼ì„ ë°ì´í„° URLë¡œ ì½ìŒ
          reader.readAsDataURL(file);
          listItem.appendChild(filePreview);

          // íŒŒì¼ ì •ë³´(ì´ë¦„ê³¼ í¬ê¸°)ë¥¼ í‘œì‹œí•˜ê¸° ìœ„í•œ <span> ìš”ì†Œë¥¼ ìƒì„±
          let fileInfo = document.createElement('span');
          // ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œì˜ í…ìŠ¤íŠ¸ ë‚´ìš©ì„ íŒŒì¼ ì´ë¦„ê³¼ íŒŒì¼ í¬ê¸°ë¡œ ì„¤ì •
          fileInfo.textContent = `${file.name} (${formatFileSize(file.size)})`;
          listItem.appendChild(fileInfo);

          let deleteButton = document.createElement('button');
          deleteButton.textContent = 'Delete';
          deleteButton.classList.add('delete-btn');

          // ì‚­ì œ ë²„íŠ¼ì„ í´ë¦­í–ˆì„ ë•Œ ì‹¤í–‰ë˜ëŠ” ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ì¶”ê°€
          deleteButton.addEventListener('click', () => {
            listItem.remove();
          });

          listItem.appendChild(deleteButton);
          fileList.appendChild(listItem);
        });
      });

      // íŒŒì¼ í¬ê¸°ë¥¼ ì‚¬ëŒì´ ì½ê¸° ì‰¬ìš´ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
      function formatFileSize(size) {
        // ê¸°ì¡´ ì½”ë“œë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©
      }

      // ì´ë¯¸ì§€ í¬ê¸°ë¥¼ ì¡°ì •í•˜ëŠ” í•¨ìˆ˜
      function resizeImage(src, maxWidth, maxHeight, callback) {
        // ê¸°ì¡´ ì½”ë“œë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©
      }

      cancelBtn.addEventListener('click', () => {
        document.querySelector('.title').value = '';
        document.querySelector('.text_box').value = '';
        history.back();
      });
    </script>
  </body>
</html>
